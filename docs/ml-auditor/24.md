# 二十四、数据探索

本章展示了我们如何对原始数据应用探索性数据分析(EDA ),以从数据中获得洞察力。使用一些最常用的方法研究样本数据集。本分析展示了检查缺失值、发生频率和变量间相关性的技术。

这一章的结构就像一个秘籍——秘籍的目标、配料、说明、变化和服务。随附的代码可以在第 [20](20.html) 章指定的 GitHub 存储库中获得。

## 菜肴:通过探索了解数据

EDA 是通过使用数据可视化和统计方法总结数据的主要组成部分来分析数据。这是将数据用于 ML 或数据科学时首先使用的方法之一。为了理解原始数据，可以可视化数据并检查缺失值，以确定数据中的相关性。在本分析中，我们将探讨由阿尔伯塔省政府提供的公开可用的新冠肺炎病例汇总数据。

## 佐料

用于分析的数据是 2020 年 3 月 6 日至 2021 年 1 月 6 日向艾伯塔省卫生服务机构报告的新冠肺炎病例的汇总病例数据。

表 24-1

covid19dataexport.csv 的列数据

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"></colgroup> 
| 

圆柱

 | 

描述

 |
| --- | --- |
| 未命名列 | 第一列是未命名的，包含一个自动生成的数字。 |
| 报告日期 | 案例的报告日期。 |
| 艾伯塔卫生服务区 | 区域地带 |
| 性别 | 患者的性别 |
| 年龄层 | 年龄范围 |
| 案例状态 | 指示截至数据提取日期，患者是否已康复或病例是否仍处于活动状态。 |
| 案例类型 | 指示案例是否得到确认。 |

## 说明

在探索性数据分析之前，只有两个主要步骤。首先你准备数据。然后你进行实际的探索。

### 步骤 1:数据准备

第一个数据准备步骤是重命名列。第一个未命名的列有一个名称，以便于识别。其他列大多被重命名为更小或更合理的列名。

此分析中使用的另一个数据准备是标签编码，它类似于一键编码。一键编码(OHE)是转换数据，为算法做准备并优化预测。在标签编码中，列中的每个分类值都被转换为数值。例如，“性别”字段有三个类别:男性、女性和未知。在这里，男性被指定为 0，女性被指定为 1，而未知被设置为 2。

### 步骤 2:探索性数据分析

将数据加载到 Jupyter Notebook 后，将检索数据框的形状。共有 108，469 个报告病例，包含七个特征变量。

接下来检查“报告日期”日期，以确定所提供数据集的最早和最晚报告日期。最早报告的日期是 2020 年 3 月 6 日，最晚报告的病例是 2021 年 1 月 6 日。这确认了数据集的预期周期。

使用内置的`duplicated()`函数检查数据是否重复。当两行或多行具有相同的值时，就会出现重复。重复会影响 ML 算法的性能。数据集中没有重复项。

使用名为`count()`的函数检查缺失值。count 函数显示在所有列中找到的总值。可以使用`isnull()`函数显示空值。在提供的示例中，没有丢失值。如果发现缺少的值，应该用占位符替换它们。这可以使用`replace()`或`fillna()`功能来完成。缺少值会对算法产生负面影响，因此删除它们或用期望值填充它们会更好。另一种常用于替换空数值变量的方法是用其他可用值计算出的平均值替换所有空值。

value_counts()函数有助于理解按各列对数据进行的细分。结果被可视化以清楚地说明计数。以下是运行 value_counts 函数后列的摘要:

*   状态。大多数已康复的报告病例与活动和死亡病例相比较。与现状相比，死亡病例只是一小部分。

*   AHS 区。埃德蒙顿和卡尔加里地区报告了超过 40，000 例病例。北部、中部和南部地区报告的病例要少得多，各在 6000-8000 例左右。

*   年龄。中年人(30-39 岁和 20-29 岁)报告的病例最多。一岁以下儿童报告的病例最少。

*   报告日期。春季和夏季(4 月至 8 月)病例较少。冬季报告的病例最多。12 月的病例数最高，大约是夏季的五倍。

*   男性患者和女性患者一样多，大约各有 54，000 例。

最后构建一个相关矩阵，以查看数据集中提供的所有可能变量对之间的相关性。最好用相互之间有线性关系的变量来衡量。热图和结对图通常用于显示变量之间的关系。数据集中没有显著的相关性。年龄和地位之间有一些负相关，但这种负相关很小，这可以从 pairs 图中得到证实。

## 变化和服务

在本分析中，前面已经描述了插补方法。插补是用替代值替换空值的方法。丢弃缺失值可能会导致数据的偏差或误报。假设我们在教室里测量学生的身高。班上有七名学生，他们的身高在 150-170 厘米之间。今天有三个学生缺席，他们的身高无法测量。如果只使用七个学生的身高，我们将只有学生身高的全部可能数据的 70%的代表性。

弥补缺课学生的更好方法是将缺课学生的身高设置为班上七名学生的平均值，在本例中为 160 厘米。这是一个更好的数据集。变量的模式是另一种可以用来估算值的方法。众数是出现次数最多的值。如果高度出现的最大数量是 162 厘米，这将是高度变量的模式。

用于数据探索的脚本可以被标准化为在任何被分析的数据集上执行的一系列测试。本章介绍的技术是一些最常用的方法。可以开发和利用更全面的数据探索测试列表来理解数据。

## 结论

在本章中，您已经了解了如何应用探索性数据分析来从原始数据中获得洞察力。这种分析对于寻找和理解缺失值背后的原因、发生频率以及您在探索步骤中可能发现的任何其他异常都很有价值。